/* TencentVideo FE @ 2017/9/7 16:1:44. V2.0.0 Copyright (c) 2017 */ 
!function(t,o){"object"==typeof exports&&"object"==typeof module?module.exports=o():"function"==typeof define&&define.amd?define([],o):"object"==typeof exports?exports.uploadExtend=o():t.uploadExtend=o()}(this,function(){return function(t){function o(e){if(n[e])return n[e].exports;var i=n[e]={exports:{},id:e,loaded:!1};return t[e].call(i.exports,i,i.exports,o),i.loaded=!0,i.exports}var n={};return o.m=t,o.c=n,o.p="",o(0)}([function(t,o,n){"use strict";var e=n(1),i=n(3),r=n(4),c=n(2),a=n(6),u=!1,l=window.navigator.userAgent,f=function(){if(l.indexOf("MSIE")>0||l.indexOf("Trident/")>0||l.indexOf("Edge/")>0)return!0}(),s=l.toLowerCase().indexOf("firefox")>-1,p=l.toLowerCase().indexOf("safari")>-1,d=l.toLowerCase().indexOf("windows")>-1;window.isVplus=!1,window.isMpub=0,window.isPay=!1;var c=window.$j||window.$;window.uploadExtend=t.exports={init:function(){this.loginCheck(),this.uploadPermissionCheck(),this.bindUiEvent(),txv.common.initPage()},isIe:f,isFirefox:s,isSafari:p,isWindows:d,reset:function(){c(window).unbind("beforeunload"),window.onbeforeunload=null,c("#tvu_flashuploader_obj").show(),c(".j_first_page").show(),c(".j_second_page").hide(),tvu.hasFtn()||(d&&p||tvu.hasFtnHtml5()?c("#ftn_install_tips_cont").hide():c("#ftn_install_tips_cont").show()),window.isWindows||c(".j_pc_client_container").hide(),window.isVplus||c(".j_om_login_intro").hide()},loginCheck:function(){txv.login.addLogoutCallback(function(){location.href=location.protocol+"//v.qq.com"}),txv.login.addLoginCallback(function(){txv.login.isLogin()&&!txv.login.getUin()?(c(window).unbind("beforeunload"),window.onbeforeunload=null,location.href=location.protocol+"//v.qq.com"):location.reload()}),txv.login.isLogin()&&!txv.login.isLowLogin()||(txv.login.openLogin(),c(".j_upload_option").removeClass("j_upload_option"),c("#upload_button").remove(),c(".btn_select_file").remove(),c("#tvu_flashuploader_obj").remove()),txv.login.isWxLogin()&&(window.location.href=location.protocol+"//v.qq.com")},uploadPermissionCheck:function(){r.check(function(t){window.isMpub=t.mpub,window.isPay=1===t.pay,window.isVplus=t.isauth;var o=t.act||{},n=window.g_actList||{};window.isVplus&&(c(".j_om_login_intro").show(),a.report({target:5})),c(".j_om_login_btn").on("click",function(){a.report({target:6})});var e=txv&&txv.util&&txv.util.getUrlParam("act")||"",i=o.actname||n[e];e&&(o.actvalid||void 0!==i||i?c("#reupload_title").text('"'+i+'" 专属上传入口'):(c("#upload_button").hide(),c(".btn_select_file").hide(),c("#tvu_flashuploader_obj").remove(),c("#btn_upload_desc").text("该专属上传入口已关闭").css("color","grey").show(),c("#reupload_title_notice").text("（活动不在有效期，谢谢关注）").show()))}),uploader.$phonebind()},bindUiEvent:function(){c(document).on("mouseover",".j_upload_option",function(){c(this).addClass("upload_option_hover")}),c(document).on("mouseout",".j_upload_option",function(){c(this).removeClass("upload_option_hover")}),c(document).on("mouseover",".j_notice_tips_list li.item",function(){c(this).addClass("item_active")}),c(document).on("mouseout",".j_notice_tips_list li.item",function(){c(this).removeClass("item_active")}),tvu.hasFtn()||d&&p||tvu.hasFtnHtml5()||c("#ftn_install_tips_cont").show(),c("#install_ftn_btn").attr("href",c("#install_ftn_btn").attr("href")+encodeURIComponent(window.location.href)),d?c(".j_use_pc_client").click(function(){a.report({target:4}),i.exist().done(function(){i.open("qqlive://openchannel/tab=upload")}).fail(function(){if(window.confirm("未检测到腾讯视频客户端，是否前往下载?"))try{window.location.assign("//node.video.qq.com/x/api/download_pc")}catch(t){window.open("http://v.qq.com/download.html","_blank")}})}):c(".j_pc_client_container").hide(),e.check(function(t){0===t.viewed_flag?(c(".pop_protocol").show(),c("#upload_button").hide(),c("#protocol_close").click(function(){c(".pop_protocol").hide()}),c("#protocol_confirm").click(function(){c(".pop_protocol").hide(),e.set(function(){location.reload()})})):(u=!0,c("#upload_button").show())}),c("#readed_agreement").on("change",function(){var t=c(this).prop("checked");"false"!==t&&t?u&&c("#upload_button").show():(c("#upload_button").hide(),alert("请先同意遵守腾讯视频上传服务规则"))})},showDialog:function(t){var o={title:c('[data-role="dialog-title"]'),msg:c('[data-role="dialog-msg"]'),msg2:c('[data-role="dialog-msg2"]'),inputTitle:c('[data-role="dialog-input-title"]')},n=c('[data-role="dialog-input"]'),e=c('[data-role="dialog-input-value"]'),i=c('[data-role="dialog"]'),r=c('[data-role="dialog-close"]');if(t){for(var a in o)t.hasOwnProperty(a)?o[a].html(t[a]).show():o[a].html("").hide();t.isInputShow?(n.show(),t.inputValue&&e.val(t.inputValue)):n.hide(),r.off("click").on("click",function(){i.hide()}),i.show()}}}},function(t,o,n){"use strict";var e=n(2);t.exports={check:function(t){e.ajax({url:location.protocol+"//c.v.qq.com/checkprotocolviewed?otype=json&op=get",dataType:"jsonp",CSRF:!0,success:function(o){t&&t(o)}})},set:function(){e.ajax({url:location.protocol+"//c.v.qq.com/checkprotocolviewed?otype=json&op=set",dataType:"jsonp",CSRF:!0,success:function(t){cb&&cb(t)}})}}},function(t,o){"use strict";t.exports=window.$j||window.$||window.jQuery},function(t,o){function n(t){l=!1;var o=f,n=o.shift();for(f=[];n;)n(t),n=o.shift()}function e(t){txv.client?t(txv.client):l?f.push(t):(l=!0,f.push(t),$.getScript("//vm.gtimg.cn/tencentvideo_v1/script/module/txv.client.js",function(){l&&n(txv.client)}),setTimeout(function(){l&&n()},3e3))}function i(t){var o=p,n=o.shift();for(p=[];n;)t?n.resolve(t):n.reject(),n=o.shift();s=!1}function r(t,o,n){var r=$.Deferred();return p.push(r),s||(s=!0,e(function(e){e?e.exist(t,o,n).done(function(t){i(t)}).fail(function(){i()}):i()})),r}function c(t,o,n,i){var r=$.Deferred();return e(function(e){e?e.open(t,o,n,i).done(function(){r.resolve()}).fail(function(){r.reject()}):r.reject()}),r}function a(){var t=$.Deferred();return e(function(o){o?o.pull().done(function(){t.resolve()}).fail(function(o){t.reject(o)}):t.reject(-1)}),t}function u(){return r(!0,!1,!0)}var l=!1,f=[],s=!1,p=[];t.exports={exist:r,open:c,pull:a,hasService:u}},function(t,o,n){var e=n(2),i=n(5);t.exports={check:function(t){var o=txv&&txv.util&&txv.util.getUrlParam("act")||"";e.ajax({url:location.protocol+"//c.v.qq.com/vupcheck",dataType:"jsonp",CSRF:!0,data:{otype:"json",uin:txv.login.getUin(),t:0,act:o||""},success:function(o){if(o&&100001===o.em)return void txv.login.openLogin();if("f"===o.s)if(1302===o.em)i.show({msg:"非常抱歉，您还未开通视频上传权限。若需要开通权限，请向类目运营经理申请。"}),e(".j_upload_page").hide();else if(1111===o.em)i.show({msg:o.msg,btnText:"申诉",callback:function(){location.href=location.protocol+"//v.qq.com/help/boke_6.html"}}),e(".j_upload_page").hide();else{var n=o.msg;8001===o.em&&(n+="(错误码："+o.em+")"),i.show({msg:n}),e(".j_upload_page").hide()}else t&&t(o)},error:function(){i.show({msg:"对不起，页面加载出现错误，请尝试刷新页面或稍后再试。",btnText:"刷新",callback:function(){location.reload()}}),e(".j_upload_page").hide()}})}}},function(t,o,n){"use strict";var e="#error_step",i=n(2);t.exports={show:function(t){var o=t.msg||"系统出现错误，请稍后再试。",n=t.btnText||"返回我的上传",r=t.callback||function(){location.reload()};i(e+"_content").text(o),i(e+"_btn").text(n).off("click").on("click",r),i(e).show()},hide:function(t){i(e).hide()}}},function(t,o,n){"use strict";function e(t){var o=[];return c.objEach(t,function(t,n){var e=t+"="+encodeURIComponent(n);o.push(e)}),o.length>0?o.join("&"):""}function i(t){var o=e(t),n=a+o;new Image(1,1).src=n}function r(){u.url=location.href,u.uin=txv.login.getUin(),u.target=""}var c=n(7),a="http://btrace.qq.com/kvcollect?BossId=4058&Pwd=426519366&",u={url:location.href,uin:txv.login.getUin(),target:"",ua:navigator.userAgent},l={};t.exports={config:function(t){u=c.extend(u,t)},report:function(t){r(),u=c.extend(u,t),i(u)},reportOnce:function(t,o){l[t]||(l[t]=!0,this.report(o))}}},function(t,o,n){"use strict";var e=n(8),i={};t.exports=e.extend({},e,{slice:function(t){if(!t||!t.length)return[];for(var o=t.length,n=[],e=0;e<o;e++)n.push(t[e]);return n},cookie:{get:function(t){for(var o=document.cookie,n=o.split(";"),e=0,i=n.length;e<i;e++){var r=n[e].split("="),c=r[0]||"";c=c.replace(/\W+/,"");var a=r[1]||"";if(c===t)return a}}},getCoverSrcByVid:function(t,o){if(i[t]){var n=i[t];return o?n+"?t="+(new Date).getTime():n}var e=location.protocol+"//vpic.video.qq.com/",r=function(t){for(var o=0,n=0;n<t.length;n++)o=(o<<5)+o+t.charCodeAt(n);return o%1e8}(t),c=e+r+"/"+t+"_160_90_3.jpg";return i[t]=c,o?c+"?t="+(new Date).getTime():c}})},function(t,o){"use strict";function n(t,o){return t&&t.hasOwnProperty&&t.hasOwnProperty(o)}var e={escape:function(t){return t?String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#39;").replace(/"/g,"&quot;"):""},type:function(t){if(null===t)return"null";if(void 0===t)return"undefined";var o=/\[object (\w+)\]/.exec(Object.prototype.toString.call(t));return o?o[1].toLowerCase():""},keys:function(t){var o=[];return t?Object.keys?Object.keys(t):(this.objEach(t,function(t){o.push(t)}),o):o},bind:function(t,o){return t.bind?t.bind(o):function(){return t.apply(o,arguments)}},extend:function(t){if("object"!=this.type(t)&&"function"!=this.type(t))return t;for(var o,e,i=1,r=arguments.length;i<r;i++){o=arguments[i];for(e in o)n(o,e)&&(t[e]=o[e])}return t},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/gm,"")},indexOf:function(t,o){if(t.indexOf)return t.indexOf(o);var n=-1;return e.some(t,function(t,e){if(t===o)return n=e,!0}),n},forEach:function(t,o){if(t.forEach)return t.forEach(o);for(var n=t.length,e=0;e<n;e++)o(t[e],e);return t},some:function(t,o){if(t.some)return t.some(o);for(var n=t.length,e=!1,i=0;i<n;i++)if(o(t[i],i)){e=!0;break}return e},map:function(t,o){if(t.map)return t.map(o);for(var n=t.length,e=[],i=0;i<n;i++)e.push(o(t[i],i));return e},objEach:function(t,o){if(t)for(var e in t)if(n(t,e)&&!1===o(e,t[e]))break},reduce:function(t,o){if("function"!=e.type(o))throw new TypeError("Array.prototype.reduce callback must be a function");var n=t.length;if(0===n&&2===arguments.length)throw new TypeError("reduce of empty array with no initial value");var i,r=0;if(arguments.length>=3)i=arguments[2];else for(;;){if(r in t){i=t[r++];break}if(++r>=n)throw new TypeError("reduceRight of empty array with no initial value")}for(;r<n;r++)i=o(i,t[r],r,t);return i},filter:function(t,o,n){if(t.filter)return t.filter(o);for(var e=t.length,i=[],r=0;r<e;r++){var c=t[r];o.call(n,c,r,t)&&i.push(c)}return i},nextTick:function(){var t=this;return function(){setTimeout.apply(t,arguments)}}(),lock:function(t){var o;return function(){if(!o){o=!0;var n=[].slice.call(arguments,0);n.unshift(function(){o=!1}),t.apply(this,n)}}},queue:function(t,o){function n(){var t=i.shift();if(!t)return void(r=o);r--;var c=t[0],a=t[1],u=t[2];u.unshift(function(){r++,n.apply(this,arguments)}),e.nextTick(function(){return c.apply(a,u)})}o=o||1;var i=[],r=o;return function(){if(i.push([t,this,[].slice.call(arguments,0)]),r)return n()}},delegator:function(t){var o,n=[];return function(i){if(o)return n.push(i);o=!0,t.call(this,function(){o=!1;var t=this,r=arguments;i&&i.apply(t,r),e.forEach(n,function(o){o&&o.apply(t,r)})})}},once:function(t){var o,n=arguments;return function(){if(!o&&t)return o=!0,t.apply(n.length>=2?n[1]:null,arguments)}},verCompare:function(t,o){if(t===o)return 0;t=t.split("."),o=o.split(".");for(var n=t.length>=o.length?t.length:o.length,e=0;n--;){var i=Number(t[e]||0),r=Number(o[e++]||0);if(r>i)return 1;if(r<i)return-1}return 0}};t.exports=e}])});